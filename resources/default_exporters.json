[
  {
    "name": "Selektion (Excel)",
    "id": 2,
    "type": "Excel",
    "encoding": "UTF8",
    "delimiter": ";",
    "columns": ["perid", "titel", "anrede", "vorname", "nachname", "geburtsdatum", "strasse", "plz", "ort", "land", "zielgruppe ID", "zielgruppe", "telefon", "mobilnr", "email"],
    "rules": [
      {
        "action": "copy",
        "from": "contact.id",
        "to": "perid"
      },
      {
        "action": "copy",
        "from": "contact.formal_title",
        "to": "titel"
      },
      {
        "action": "copy",
        "from": "contact.individual_prefix",
        "to": "anrede"
      },
      {
        "action": "preg_replace",
        "from": "anrede",
        "search": "#^$#",
        "replace": "An",
        "to": "anrede"
      },
      {
        "action": "copy",
        "from": "contact.first_name",
        "to": "vorname"
      },
      {
        "action": "copy",
        "from": "contact.last_name",
        "to": "nachname"
      },
      {
        "action": "date",
        "from": "contact.birth_date",
        "format": "d.m.Y",
        "to": "geburtsdatum"
      },
      {
        "action": "copy",
        "from": "contact.street_address",
        "to": "strasse"
      },
      {
        "action": "copy",
        "from": "contact.postal_code",
        "to": "plz"
      },
      {
        "action": "copy",
        "from": "contact.city",
        "to": "ort"
      },
      {
        "action": "copy",
        "from": "contact.country",
        "to": "land"
      },
      {
        "action": "copy",
        "from": "segment.segment_id",
        "to": "zielgruppe ID"
      },
      {
        "action": "copy",
        "from": "segment.segment_name",
        "to": "zielgruppe"
      },
      {
        "action": "copy",
        "from": "phone_phone.phone",
        "to": "telefon"
      },
      {
        "action": "copy",
        "from": "phone_mobile.phone",
        "to": "mobilnr"
      },
      {
        "action": "copy",
        "from": "contact.email",
        "to": "email"
      },
      {
        "comment": "calculate file name",
        "action": "set",
        "value": "now",
        "to": "file_date"
      },
      {
        "action": "date",
        "from": "file_date",
        "format": "Ymd_His",
        "to": "file_date"
      },
      {
        "action": "append",
        "from": "campaign.title",
        "separator": "_",
        "to": "file_date"
      },
      {
        "action": "append",
        "from": "campaign.id",
        "separator": "_",
        "to": "file_date"
      },
      {
        "action": "sprintf",
        "from": "file_date",
        "format": "%s.csv",
        "to": "file_date"
      },
      {
        "action": "setfilename",
        "from": "file_date"
      }
    ]
  },


  {
    "name": "Lettershopformat (Excel)",
    "id": 3,
    "type": "Excel",
    "columns": ["id", "titel", "anrede", "vorname", "nachname", "co", "strasse", "plz", "ort", "postfach", "land", "zielgruppe ID", "zielgruppe", "paket", "kundennummer", "sepa_belegart", "iban_empfaenger", "bic_empfaenger", "pruefziffer"],
    "rules": [
      {
        "action": "copy",
        "from": "contact.id",
        "to": "id"
      },
      {
        "action": "copy",
        "from": "contact.formal_title",
        "to": "titel"
      },
      {
        "action": "copy",
        "from": "contact.individual_prefix",
        "to": "anrede"
      },
      {
        "action": "preg_replace",
        "from": "anrede",
        "search": "#^$#",
        "replace": "An",
        "to": "anrede"
      },
      {
        "action": "copy",
        "from": "contact.first_name",
        "to": "vorname"
      },
      {
        "action": "copy",
        "from": "contact.last_name",
        "to": "nachname"
      },
      {
        "action": "copy",
        "from": "contact.supplemental_address_1",
        "to": "co"
      },
      {
        "action": "copy",
        "from": "contact.street_address",
        "to": "strasse"
      },
      {
        "action": "copy",
        "from": "contact.postal_code",
        "to": "plz"
      },
      {
        "action": "copy",
        "from": "contact.city",
        "to": "ort"
      },
      {
        "action": "copy",
        "from": "contact.country",
        "to": "land"
      },
      {
        "action": "copy",
        "from": "segment.segment_id",
        "to": "zielgruppe ID"
      },
      {
        "action": "copy",
        "from": "segment.segment_name",
        "to": "zielgruppe"
      },
      {
        "action": "copy",
        "from": "segment.test_group",
        "to": "paket"
      },
      {
        "action": "sprintf",
        "from": "campaign.id",
        "format": "%04d",
        "to": "kundennummer"
      },
      {
        "action": "sprintf",
        "from": "contact.id",
        "format": "C%09d",
        "to": "kundennummer_contact"
      },
      {
        "action": "append",
        "from": "kundennummer_contact",
        "separator": "",
        "to": "kundennummer"
      },
      {
        "action": "set",
        "value": "32+",
        "to": "sepa_belegart"
      },
      {
        "action": "set",
        "value": "IBANPLACEHOLDER",
        "to": "iban_empfaenger"
      },
      {
        "action": "set",
        "value": "GIBAATWWXXX",
        "to": "bic_empfaenger"
      },
      {
        "action": "mod97",
        "from": "kundennummer",
        "to": "pruefziffer"
      },
      {
        "action": "sprintf",
        "from": "pruefziffer",
        "format": "%s11",
        "to": "pruefziffer"
      },
      {
        "comment": "calculate file name",
        "action": "set",
        "value": "now",
        "to": "file_date"
      },
      {
        "action": "date",
        "from": "file_date",
        "format": "Ymd_His",
        "to": "file_date"
      },
      {
        "action": "append",
        "from": "campaign.title",
        "separator": "_",
        "to": "file_date"
      },
      {
        "action": "append",
        "from": "campaign.id",
        "separator": "_",
        "to": "file_date"
      },
      {
        "action": "sprintf",
        "from": "file_date",
        "format": "%s.csv",
        "to": "file_date"
      },
      {
        "action": "setfilename",
        "from": "file_date"
      }
    ]
  }
]